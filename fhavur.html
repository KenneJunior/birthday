<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="manifest" href="manifest.webmanifest" />

    <title>Happy Birthday Fhavur!</title>
    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ</text></svg>"
    />
    <!-- Apple Touch Icon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWQxOTIiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgo8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZGI0YzNmIi8+CjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6I2IwM2EyZSIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+CjxjaXJjbGUgY3g9Ijk2IiBjeT0iOTYiIHI9Ijk2IiBmaWxsPSJ1cmwoI2dyYWQxOTIpIi8+CjxwYXRoIGQ9Ik05NiAxMzQuMTY3QzExMy4zMzMgMTE3LjMzMyAxMjggMTA0IDEzMy4zMzMgOTAuNjY3QzEzNS4zMzMgODMuMzMzIDEzMiA3MiAxMjIuNjY3IDY2LjY2N0MxMTMuMzMzIDYyLjY2NyAxMDEuMzMzIDY2LjY3IDk2IDcyQzkwLjY2NyA2Ni42NjcgNzguNjY3IDYyLjY2NyA2OS4zMzMgNjYuNjdDNjAgNzIgNTYuNjY3IDgzLjMzMyA1OC42NjcgOTAuNjY3QzYwLjY2NyAxMDQgNzUuMzMzIDExNy4zMzMgOTYgMTM0LjE2N1oiIGZpbGw9IndoaXRlIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMS4zMzMiLz4KPC9zdmc+PC9zdmc+"
    />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <meta name="theme-color" content="pink" />
    <!-- Chrome, Edge, Android -->

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Animate.css -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;400;600&family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="src/css/notification.css" />
    <link rel="stylesheet" href="src/css/int.css" />
    <link rel="stylesheet" href="src/css/loading.css" />
  </head>

  <body>
    <div class="loading-container" id="loading">
      <div class="loading-spinner">
        <div class="loading-spinner-inner"></div>
      </div>
      <div class="loading-text">
        Verifying access
        <span class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </span>
      </div>
    </div>
    <!-- Background Elements -->
    <div class="glitter" aria-hidden="true"></div>

    <!-- Main Card Content -->
    <main
      class="container d-none animate__animated animate__fadeIn"
      id="protectedContent"
    >
      <!-- Decorative Ribbon -->
      <div class="ribbon ribbon-top-right" aria-hidden="true">
        <span>Happy Birthday!</span>
      </div>
      <section class="card-content">
        <figure class="image-container animate__animated animate__zoomIn">
          <img
            src="/pics/profile_pic.jpg"
            alt="Birthday girl smiling"
            id="profile_pic"
            loading="lazy"
            width="240"
            height="240"
          />
        </figure>

        <h1 class="animate__animated animate__slideInLeft" id="birthday-name">
          Happy Birthday, Princess!
        </h1>

        <blockquote class="message animate__animated animate__slideInRight">
          Hey ğŸ‘‹ Missus, <br />
          <p>
            Happy Birthday! ğŸ‰ To the 1st most amazing girl I know (after my Mom
            and Sisters ğŸ¤£ğŸ¤²) May your day shine as brightly ğŸŒ as your
            incredible spirit,filled with endless laughter ğŸ¤£, heartfelt love
            â¤ï¸, and delightful surprises ğŸ˜ that make your heart soar ğŸ’ƒ.<br />
            Wishing you a sprinkle of wit ğŸ¤“, a dash of romance ğŸ˜˜, and all your
            deepest prayers answered ğŸ™. May everything you need most find its
            way to you! <br />
            Keep being your fabulous, radiant selfâ€”you make the world sparkle!
            âœ¨ğŸ‚
          </p>
        </blockquote>

        <section
          class="memory-gallery animate__animated animate__fadeIn"
          aria-label="Memory gallery"
        >
          <h2 class="visually-hidden">Our Special Memories</h2>
          <div class="photo-gallery" id="photo-gallery"></div>
        </section>

        <button
          class="open-modal-btn"
          id="modal_open"
          aria-label="Open memory gallery"
        >
          <i class="fas fa-images" aria-hidden="true"></i> View Memories
        </button>

        <address class="signature animate__animated animate__fadeIn">
          <a href="fhavur/confession.html">
            With all my love,<br />
            Your Secret Admirer
          </a>
        </address>
        <button
          class="btn-celebrate animate__animated animate__pulse animate__infinite"
          id="celebrateBtn"
          aria-label="Celebrate birthday"
        >
          <i class="fas fa-gift" aria-hidden="true"></i> Celebrate Princess!
        </button>

        <aside
          class="social-share animate__animated animate__fadeIn"
          aria-label="Share options"
        >
          <h2 class="visually-hidden">Share this card</h2>
          <a
            href="https://api.whatsapp.com/send?text=Check%20out%20this%20beautiful%20birthday%20wish%20I%20received!"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Share on WhatsApp"
          >
            <i class="fab fa-whatsapp" aria-hidden="true"></i>
          </a>
          <a
            href="https://www.instagram.com"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Share on Instagram"
          >
            <i class="fab fa-instagram" aria-hidden="true"></i>
          </a>
          <a
            href="https://www.tictok.com"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Share on Tiktok"
          >
            <i class="fab fa-tiktok" aria-hidden="true"></i>
          </a>
        </aside>
      </section>
    </main>

    <!-- Music Player -->
    <aside class="music-player" aria-label="Music player">
      <button
        id="playBtn"
        type="button"
        class="grow-button"
        aria-label="Play music"
      >
        <i class="fas fa-play" aria-hidden="true"></i>
      </button>
      <audio id="birthdayAudio" loop aria-label="Birthday music">
        <source
          src="/Simi_ft_Adekunle_Gold_DeJa_-_Happy_Birthday.mp3"
          type="audio/mpeg"
        />
        Your browser does not support audio.
      </audio>
    </aside>

    <!-- Image Modal -->
    <dialog class="modal-overlay" id="imageModal">
      <div class="modal-container">
        <button class="modal-close" aria-label="Close modal">
          <i class="fas fa-times"></i>
        </button>

        <button class="modal-maximize" aria-label="Maximize modal">
          <i class="fas fa-expand"></i>
        </button>
        <div class="modal-tooltip">This is a tooltip message</div>
        <div class="modal-content">
          <div class="modal-image-container">
            <button class="modal-nav modal-prev" aria-label="Previous image">
              <i class="fas fa-chevron-left"></i>
            </button>
            <img
              class="modal-image zoomable"
              src=""
              alt="Enlarged memory photo"
            />
            <video
              class="modal-image modal-video zoomable"
              hidden=""
              controls
            ></video>
            <button class="modal-nav modal-next" aria-label="Next image">
              <i class="fas fa-chevron-right"></i>
            </button>
            <div class="modal-counter">1/4</div>
          </div>

          <div class="modal-social">
            <a href="#" class="share-facebook" aria-label="Share on Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="#" class="share-twitter" aria-label="Share on Twitter">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="share-pinterest" aria-label="Share on Pinterest">
              <i class="fab fa-pinterest-p"></i>
            </a>
            <a href="#" class="share-link" aria-label="Copy link">
              <i class="fas fa-link"></i>
            </a>
          </div>
        </div>
      </div>
    </dialog>

    <!-- Click Effects Container -->
    <div id="clickHearts" aria-hidden="true"></div>
    <div class="balloon"></div>

    <div
      class="pop-notification"
      aria-label="Pop notification"
      id="notification"
    >
      <div class="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      <div class="notification-header">
        <div class="notification-title">
          <i class="fas fa-bell icon"></i>
          <span id="notification-title">Notification</span>
        </div>
        <button
          class="close-btn"
          id="closeNotification"
          aria-label="Close notification"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="notification-content">
        <p class="notification-message" id="notification-message">
          Your notification message goes here. This is a default message.
        </p>
        <div class="notification-actions">
          <button class="action-btn secondary-action" id="dismiss">
            Dismiss
          </button>
          <button class="action-btn primary-action" id="view-details">
            View Details
          </button>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script type="module" src="/src/auth-check.js"></script>
    <script type="module" src="src/js/HBD.js"></script>
    <script type="module">
      import {
        updateLoadingText,
        showLoading,
        hideLoading,
        setupAuthProtection,
      } from "/src/auth-check.js";
      // Asynchronous function to initialize the protected page
      async function initializeProtectedPage() {
        updateLoadingText("Yeah I know againğŸ˜... Just a moment ğŸ˜…ğŸ˜Š");
        showLoading();

        try {
          const authResult = await setupAuthProtection();
          if (authResult.authenticated) {
            // Delay hiding loader for a smoother transition

            hideLoading();
            setTimeout(() => {
              initializePageContent();
              const protectedContent =
                document.getElementById("protectedContent");
              if (protectedContent) {
                protectedContent.classList.remove("d-none");
              }
            }, 2500);
          } else {
            // Handle case where authentication succeeds but user is not authorized
            hideLoading();
            console.warn("Access denied: User not authenticated");
            window.location.href = "/login.html";
          }
        } catch (error) {
          hideLoading();
          console.error("Authentication fail:", error);
          window.location.href = "/login.html";
        }
      }

      // Function to initialize page content after authentication
      function initializePageContent() {
        console.log("Protected content loaded successfully");
        // Enable all buttons and inputs that might have been disabled during loading
        document.querySelectorAll("button, input").forEach((element) => {
          element.disabled = false;
        });
      }

      // Check document ready state and initialize accordingly
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initializeProtectedPage);
      } else {
        initializeProtectedPage();
      }
    </script>
  </body>
</html>
